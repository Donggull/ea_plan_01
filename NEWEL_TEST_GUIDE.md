# 뉴엘 (커스텀 챗봇 시스템) 테스트 가이드

## 개요

뉴엘은 사용자가 자신만의 지식베이스를 가진 커스텀 AI 챗봇을 만들고 관리할 수 있는 시스템입니다. 이 가이드는 개발된 기능들을 체계적으로 테스트하는 방법을 제공합니다.

## 시스템 요구사항

### 환경 변수 확인
```bash
# 필수 환경 변수들이 설정되어 있는지 확인
OPENAI_API_KEY=your_openai_api_key
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
```

### 데이터베이스 확인
Supabase에서 다음 테이블들이 존재하는지 확인:
- `custom_bots` - 커스텀 챗봇 정보
- `knowledge_base` - 챗봇별 지식베이스
- `documents` - 기존 문서 시스템 (연동용)

## 테스트 시나리오

### 1. 네비게이션 테스트

#### 1.1 뉴엘 메뉴 접근
```
1. 메인 헤더에서 "뉴엘" 메뉴 클릭
2. `/newel` 페이지로 이동되는지 확인
3. 뉴엘 메인 페이지가 정상 로드되는지 확인
```

**예상 결과:**
- 뉴엘 메인 페이지 표시
- "새 챗봇 만들기" 버튼 표시
- 내 챗봇/공개 챗봇 탭 표시
- 검색 기능 표시

### 2. 챗봇 생성 테스트

#### 2.1 기본 정보 입력 테스트
```
1. "새 챗봇 만들기" 버튼 클릭
2. `/newel/create` 페이지로 이동 확인
3. 단계별 진행바 표시 확인 (1/3)
4. 챗봇 기본 정보 입력:
   - 아바타 선택 (🤖, 🧠, 💡 등)
   - 챗봇 이름: "테스트 마케팅 어시스턴트"
   - 챗봇 설명: "마케팅 전략과 캠페인 기획을 도와주는 AI 어시스턴트"
   - 태그 추가: "마케팅", "전략", "캠페인"
5. "다음 단계" 버튼 클릭
```

**예상 결과:**
- 모든 입력 필드가 정상 작동
- 태그 추가/제거 기능 정상
- 2단계로 이동

#### 2.2 지식베이스 업로드 테스트
```
1. 2단계에서 파일 업로드 영역 확인
2. 테스트 파일 업로드:
   - 텍스트 파일 (예: marketing-guide.txt)
   - 마크다운 파일 (예: strategy.md)
3. 파일 처리 상태 변화 확인:
   - 업로드 중 → 처리 중 → 준비 완료
4. 지시사항 입력: "친근하고 전문적인 톤으로 답변해주세요"
5. "다음 단계" 버튼 클릭
```

**예상 결과:**
- 파일 업로드 및 처리 상태 표시
- 업로드된 파일 목록 표시
- 파일 삭제 기능 정상 작동

#### 2.3 공개 설정 및 완료 테스트
```
1. 3단계에서 공개/비공개 설정 토글
2. 챗봇 생성 요약 정보 확인
3. "챗봇 생성하기" 버튼 클릭
4. 생성 완료 후 개별 챗봇 페이지로 이동 확인
```

**예상 결과:**
- 토글 스위치 정상 작동
- 요약 정보 정확 표시
- 챗봇 생성 후 리다이렉션

### 3. 챗봇 목록 테스트

#### 3.1 내 챗봇 목록 테스트
```
1. 뉴엘 메인 페이지에서 "내 챗봇" 탭 확인
2. 생성한 챗봇이 목록에 표시되는지 확인
3. 챗봇 카드 정보 확인:
   - 이름, 설명, 아바타
   - 지식베이스 개수
   - 사용 횟수
   - 태그 표시
4. 검색 기능 테스트: 챗봇 이름으로 검색
```

**예상 결과:**
- 생성한 챗봇이 목록에 표시
- 모든 메타데이터가 정확히 표시
- 검색 기능 정상 작동

#### 3.2 공개 챗봇 목록 테스트
```
1. "공개 챗봇" 탭 클릭
2. 공개 설정된 챗봇들 표시 확인
3. 좋아요 수, 제작자 정보 표시 확인
4. 다른 사용자의 공개 챗봇 접근 가능 여부 확인
```

**예상 결과:**
- 공개 챗봇만 필터링되어 표시
- 공개 챗봇 특별 UI 요소 표시

### 4. 챗봇 대화 테스트

#### 4.1 기본 대화 기능 테스트
```
1. 생성한 챗봇 카드 클릭
2. 개별 챗봇 페이지 `/newel/[id]` 로드 확인
3. 챗봇 정보 헤더 확인:
   - 챗봇 이름, 아바타
   - 사용 횟수, 지식베이스 개수
   - 공개/비공개 상태
4. 환영 메시지 자동 표시 확인
5. 메시지 입력 및 전송:
   - "마케팅 전략에 대해 설명해주세요"
   - Enter 키로 전송 가능 여부 확인
6. AI 응답 확인:
   - 지식베이스 기반 응답 생성
   - 응답 품질 및 관련성 확인
```

**예상 결과:**
- 대화 인터페이스 정상 작동
- RAG 시스템을 통한 지식베이스 기반 응답
- 실시간 메시지 교환

#### 4.2 지식베이스 연동 테스트
```
1. 지식베이스와 관련된 구체적 질문:
   - 업로드한 문서의 내용 관련 질문
   - 전문적인 용어나 개념에 대한 질문
2. 지식베이스 사이드바 열기:
   - 헤더의 문서 아이콘 클릭
   - 지식베이스 항목들 표시 확인
   - 각 항목의 제목, 내용 미리보기 확인
3. 지식베이스 관리:
   - 항목 삭제 기능 테스트
   - 삭제 후 대화 품질 변화 확인
```

**예상 결과:**
- 업로드한 문서 내용 기반 정확한 답변
- 지식베이스 사이드바 정상 표시
- 관리 기능 정상 작동

#### 4.3 대화 관리 기능 테스트
```
1. 대화 초기화 기능:
   - 휴지통 아이콘 클릭
   - 대화 기록 삭제 및 환영 메시지 재표시
2. 공유 기능:
   - 공유 아이콘 클릭
   - 클립보드에 링크 복사 확인
3. 설정 기능:
   - 설정 아이콘 클릭 (향후 구현)
4. 긴 대화 테스트:
   - 여러 메시지 연속 전송
   - 스크롤 및 메시지 표시 확인
```

**예상 결과:**
- 모든 관리 기능 정상 작동
- UI 상호작용 원활

### 5. RAG 시스템 테스트

#### 5.1 지식베이스 검색 정확도 테스트
```
1. 구체적 정보 질문:
   - 업로드한 문서의 특정 섹션 내용 질문
   - 키워드 기반 검색 테스트
2. 유사 질문 테스트:
   - 같은 내용을 다른 방식으로 질문
   - 의미적 유사성 검색 확인
3. 범위 밖 질문 테스트:
   - 지식베이스에 없는 내용 질문
   - 일반적인 응답 생성 확인
```

**예상 결과:**
- 관련 문서에서 정확한 정보 추출
- 높은 유사성 점수로 적절한 답변
- 지식베이스 외 내용은 일반적 응답

#### 5.2 컨텍스트 유지 테스트
```
1. 연속적인 질문:
   - 첫 질문: "마케팅 전략이 뭔가요?"
   - 후속 질문: "그 전략의 장점은?"
   - 대명사 사용: "그것을 실행하려면?"
2. 대화 맥락 유지 확인:
   - 이전 답변 참조 가능 여부
   - 전체적인 대화 흐름 자연스러움
```

**예상 결과:**
- 대화 맥락을 고려한 답변
- 이전 질문/답변 내용 적절히 참조

### 6. 성능 및 오류 테스트

#### 6.1 성능 테스트
```
1. 대용량 파일 업로드 테스트:
   - 큰 텍스트 파일 (1MB 이상) 업로드
   - 처리 시간 및 안정성 확인
2. 동시 요청 테스트:
   - 여러 브라우저 탭에서 동시 대화
   - 응답 속도 및 안정성 측정
3. 긴 메시지 테스트:
   - 매우 긴 질문 또는 답변 처리
   - UI 레이아웃 깨짐 여부 확인
```

**예상 결과:**
- 합리적인 처리 시간 내 작업 완료
- 시스템 안정성 유지
- UI 레이아웃 정상 유지

#### 6.2 오류 처리 테스트
```
1. 네트워크 오류 시뮬레이션:
   - 인터넷 연결 끊기
   - API 키 잘못 설정
2. 잘못된 입력 테스트:
   - 빈 메시지 전송
   - 특수문자, 이모지 포함 메시지
   - 매우 긴 메시지 (토큰 제한 초과)
3. 권한 오류 테스트:
   - 다른 사용자의 비공개 챗봇 접근 시도
   - 삭제된 챗봇 접근 시도
```

**예상 결과:**
- 적절한 오류 메시지 표시
- 시스템 크래시 없이 graceful 처리
- 사용자 친화적 오류 안내

### 7. 데이터베이스 무결성 테스트

#### 7.1 RLS (Row Level Security) 테스트
```
1. 사용자별 데이터 격리:
   - 다른 사용자 계정으로 접근
   - 본인 챗봇만 표시 확인
2. 공개 챗봇 접근:
   - 공개 설정된 챗봇은 모든 사용자 접근 가능
   - 비공개 챗봇은 소유자만 접근 가능
```

#### 7.2 데이터 일관성 테스트
```
1. 챗봇 삭제 시:
   - 관련 지식베이스 항목도 함께 삭제 (CASCADE)
   - 고아 레코드 생성 여부 확인
2. 사용량 카운터:
   - 대화할 때마다 usage_count 증가
   - 좋아요 기능 작동 (향후 구현)
```

## 테스트 체크리스트

### 기본 기능
- [ ] 뉴엘 메뉴 네비게이션
- [ ] 챗봇 생성 (3단계)
- [ ] 챗봇 목록 표시 (내 챗봇/공개 챗봇)
- [ ] 챗봇 검색 기능
- [ ] 개별 챗봇 페이지 접근

### 대화 기능
- [ ] 기본 메시지 송수신
- [ ] 환영 메시지 표시
- [ ] Enter 키 메시지 전송
- [ ] 실시간 응답 생성
- [ ] 대화 기록 유지

### 지식베이스 기능
- [ ] 파일 업로드 (txt, md)
- [ ] 파일 처리 상태 표시
- [ ] 지식베이스 목록 표시
- [ ] 지식베이스 기반 답변 생성
- [ ] 지식베이스 항목 삭제

### 고급 기능
- [ ] 의미적 검색 (벡터 서치)
- [ ] 대화 맥락 유지
- [ ] 공개/비공개 설정
- [ ] 챗봇 공유 기능
- [ ] 사용 통계 (usage_count)

### UI/UX
- [ ] 반응형 디자인
- [ ] 다크 모드 지원
- [ ] 애니메이션 효과
- [ ] 로딩 상태 표시
- [ ] 오류 메시지 표시

### 보안
- [ ] RLS 정책 적용
- [ ] 사용자별 데이터 격리
- [ ] API 키 보안
- [ ] 입력 유효성 검사

## 문제 해결 가이드

### 일반적인 문제들

#### 1. OpenAI API 오류
```
오류: "OpenAI API key is not configured"
해결: 환경 변수 OPENAI_API_KEY 설정 확인
```

#### 2. Supabase 연결 오류
```
오류: "Failed to fetch bots" 또는 데이터베이스 연결 실패
해결: SUPABASE_URL, SUPABASE_ANON_KEY 확인
     RLS 정책이 올바르게 설정되었는지 확인
```

#### 3. 파일 업로드 실패
```
오류: 파일 처리 중 오류 발생
해결: 파일 크기, 형식 확인
     브라우저 파일 API 지원 여부 확인
```

#### 4. RAG 응답 품질 문제
```
문제: 관련성 낮은 답변 생성
해결: 지식베이스 내용의 품질 확인
     임베딩 생성 과정 로그 확인
     유사도 임계값 조정
```

### 성능 최적화

#### 1. 응답 속도 개선
- OpenAI API 응답 시간 모니터링
- 벡터 검색 인덱스 최적화
- 불필요한 API 호출 최소화

#### 2. 사용자 경험 개선
- 로딩 상태 명확한 표시
- 오류 메시지 사용자 친화적으로 개선
- 반응형 디자인 최적화

## 향후 개선사항

### 단기 개선사항
1. PDF, DOC 파일 파싱 라이브러리 추가
2. 대화 기록 저장 및 불러오기
3. 챗봇 설정 페이지 구현
4. 좋아요/즐겨찾기 기능

### 중장기 개선사항
1. 다중 언어 지원
2. 음성 대화 기능
3. 챗봇 템플릿 시스템
4. 협업 기능 (팀 챗봇)
5. 분석 대시보드

## 결론

이 테스트 가이드를 통해 뉴엘 시스템의 모든 기능을 체계적으로 검증할 수 있습니다. 각 테스트 시나리오를 순서대로 실행하고, 문제 발생 시 문제 해결 가이드를 참조하여 해결하시기 바랍니다.

정기적인 테스트 실행을 통해 시스템의 안정성과 사용자 경험을 지속적으로 개선해나가시기 바랍니다.