**너는 MCP를 사용할 수 있어. 적용되어 있는 MCP를 우선적으로 사용하면서 작업을 진행해줘.**

# Recent Development Updates (2025-08-25)

- ✅ Fixed project loading errors by updating default user ID in ProjectService
- ✅ Fixed infinite recursion error in project creation by updating Supabase RLS policies
- ✅ Updated RLS policies to use correct UUID (afd2a12c-75a5-4914-812e-5eedc4fd3a3d)
- ✅ Tested project creation functionality - working correctly
- ✅ Improved error handling and logging in project service
- ✅ Optimized performance by removing complex joins
- ✅ Enhanced debugging capabilities with comprehensive console logging

# 웹·앱 서비스 기획자 통합 플랫폼 PRD

## 1. 제품 개요

### 1.1 제품 비전

서비스 기획자를 위한 **AI 기반 통합 워크플로우 플랫폼**으로, 제안 진행부터 구축 관리, 운영 관리까지 전 과정을 하나의 플랫폼에서 효율적으로 처리할 수 있는 종합 솔루션

### 1.2 제품 목표

- **효율성**: 기획자의 업무 시간을 50% 단축
- **품질 향상**: AI 기반 자동화로 일관성 있는 산출물 생성
- **통합성**: 분산된 도구들을 하나의 플랫폼으로 통합
- **확장성**: 팀 규모와 프로젝트 복잡도에 따른 유연한 확장

### 1.3 타겟 사용자

- **1차 타겟**: 프리랜서 웹·앱 기획자 및 개발자
- **2차 타겟**: 중소 웹 에이전시 및 스타트업
- **3차 타겟**: 기업 내 디지털 기획팀 및 PM

## 2. 핵심 기능 정의

### 2.1 1차 카테고리 구조

#### A. 제안 진행 (Proposal Management)

**목적**: RFP 분석부터 제안서 작성까지 자동화된 제안 프로세스

**세부 카테고리**:

1. **RFP 분석 및 정리**
   - 문서 업로드 및 자동 파싱
   - 요구사항 추출 및 구조화
   - 위험 요소 및 기회 요인 분석

2. **시장 조사 자동화**
   - 경쟁사 분석 (웹 검색 기반)
   - 기술 트렌드 조사
   - 예산 및 일정 벤치마킹

3. **제안서 작성**
   - AI 기반 제안서 초안 생성
   - 템플릿 기반 구조화
   - 실시간 협업 편집

4. **비용 산정 및 일정 계획**
   - 자동 비용 계산
   - 리소스 계획 수립
   - 위험 요소 반영

#### B. 구축 관리 (Development Management)

**목적**: 프로젝트 실행 단계의 체계적 관리

**세부 카테고리**:

1. **현황 분석 정리**
   - 현재 시스템 분석
   - 문제점 및 개선 사항 도출
   - 사용자 니즈 분석

2. **요구사항 정리**
   - 기능 요구사항 명세
   - 비기능 요구사항 정의
   - 우선순위 매트릭스

3. **기능 정의**
   - 사용자 스토리 작성
   - 기능 명세서 생성
   - API 설계

4. **화면 설계**
   - 와이어프레임 생성
   - 프로토타입 제작
   - 사용자 플로우 다이어그램

5. **WBS 일정 관리**
   - 작업 분해 구조
   - 일정 계획 및 추적
   - 마일스톤 관리

6. **QA 관리**
   - 테스트 계획 수립
   - 버그 추적 및 관리
   - 품질 메트릭 관리

7. **종합 인사이트**
   - 프로젝트 대시보드
   - 진행률 분석
   - 리스크 모니터링

#### C. 운영 관리 (Operation Management)

**목적**: 서비스 런칭 후 지속적 운영 관리

**세부 카테고리**:

1. **요건 관리**
   - 고객 요청 사항 접수
   - 요건 분류 및 우선순위
   - 승인 프로세스 관리

2. **업무 분배 관리**
   - **기획**: 요구사항 분석, 기능 정의
   - **디자인**: UI/UX 설계, 프로토타입
   - **퍼블리싱**: 마크업, 스타일링
   - **개발**: 백엔드/프론트엔드 개발

3. **일정 관리**
   - 스프린트 계획
   - 태스크 할당 및 추적
   - 일정 지연 알림

4. **성과 관리**
   - KPI 모니터링
   - 사용자 피드백 수집
   - 개선 계획 수립

### 2.2 AI 챗봇 시스템

#### A. 멀티 모델 지원

**지원 모델**:

- **Gemini API**: 메인 AI 모델 (빠른 응답, 비용 효율적)
- **ChatGPT API**: GPT-4 모델 (고품질 텍스트 생성)
- **Claude API**: Claude 모델 + MCP 연동 (도구 통합)

**모델 선택 기준**:

- 작업 복잡도
- 응답 속도 요구사항
- 정확도 우선순위
- 비용 고려사항

#### B. MCP (Model Context Protocol) 연동

**연동 도구**:

- **웹 검색**: 실시간 정보 수집
- **파일 시스템**: 문서 읽기/쓰기
- **데이터베이스**: Supabase 연동
- **API 호출**: 외부 서비스 통합

#### C. 대화 기록 관리

**기능**:

- 대화 기록 자동 저장 (Supabase)
- 프로젝트별 대화 분류
- 검색 및 필터링
- 대화 내용 요약

#### D. RAG (Retrieval-Augmented Generation) 기능

**커스텀 챗봇 생성**:

- 배경 지식 업로드 (PDF, DOC, TXT)
- 벡터 데이터베이스 구축
- 컨텍스트 기반 응답 생성
- 챗봇 공개/비공개 설정

**사이드바 통합**:

- 개인 챗봇 목록
- 공개 챗봇 탐색
- 즐겨찾기 관리
- 사용 통계

### 2.3 코드 캔버스 시스템

#### A. 코드 실행 환경

**지원 언어/프레임워크**:

- HTML/CSS/JavaScript
- React/Vue/Angular
- Python (데이터 분석)
- Node.js (백엔드 로직)

**실행 환경**:

- 브라우저 내 샌드박스
- 보안 격리 환경
- 리소스 제한 설정

#### B. 캔버스 기능

**핵심 기능**:

- **미리보기**: 실시간 코드 실행
- **편집**: 인라인 코드 수정
- **새창 보기**: 독립 창에서 실행
- **저장/공유**: 코드 스니펫 관리

**사용자 인터페이스**:

- 우측 사이드바 캔버스
- 입력창 캔버스 버튼
- 분할 화면 모드
- 전체 화면 모드

### 2.4 이미지 생성 시스템

#### A. AI 모델 지원

**지원 모델**:

1. **Flux Schnell**
   - 빠른 생성 속도 (3-5초)
   - 일반적인 이미지 생성
   - 비용 효율적

2. **Google Imagen 3**
   - 고품질 이미지 생성
   - 텍스트 정확도 높음
   - 상업적 사용 가능

3. **Flux Context Model** (자동 선택)
   - 이미지 업로드 시 자동 활성화
   - 일관성 있는 캐릭터/스타일 유지
   - 시리즈 이미지 생성

#### B. 이미지 생성 패널

**입력 필드**:

- **프롬프트**: 이미지 설명 (한국어/영어)
- **스타일**: 사전 정의된 스타일 옵션
- **개수**: 1-4개 동시 생성
- **크기**: 정사각형, 세로, 가로 비율
- **참조 이미지**: 업로드 이미지 기반 생성

**고급 옵션**:

- **시드값**: 재현 가능한 생성
- **단계수**: 품질 vs 속도 조절
- **가이던스**: 프롬프트 준수도

#### C. 이미지 관리 시스템

**이미지 목록 페이지**:

- 그리드/리스트 뷰
- 생성 날짜별 정렬
- 태그 및 검색 기능
- 프로젝트별 분류

**편집 기능**:

- 이미지 메타데이터 편집
- 태그 추가/제거
- 프로젝트 할당
- 일괄 삭제/이동

**재편집 기능**:

- 기존 이미지 기반 재생성
- Flux Context 자동 활성화
- 프롬프트 수정 히스토리
- 버전 비교

### 2.5 문서 관리 시스템

#### A. RFP 문서 관리

**업로드 지원 형식**:

- PDF, DOC, DOCX
- HWP (한글 문서)
- TXT, MD (마크다운)
- 이미지 (OCR 처리)

**자동 처리 기능**:

- **텍스트 추출**: OCR 및 파싱
- **구조 분석**: 목차 및 섹션 인식
- **요구사항 추출**: AI 기반 핵심 내용 분석
- **메타데이터 생성**: 프로젝트 정보, 예산, 일정

#### B. 참고 사항 관리

**입력 항목**:

- **프로젝트 배경**: 고객사 정보, 비즈니스 컨텍스트
- **제약 사항**: 기술적 제약, 예산 한계, 일정 제약
- **우선순위**: 핵심 요구사항 순위
- **특이사항**: 고객 요청, 브랜드 가이드라인

**AI 활용**:

- 참고 사항 기반 답변 생성
- 프로젝트 컨텍스트 유지
- 일관성 있는 응답 보장

#### C. 데이터베이스 설계 권장사항

**Supabase 활용 영역**:

- **구조화된 데이터**: 사용자, 프로젝트, 대화 기록
- **실시간 기능**: 협업, 알림, 상태 동기화
- **인증/권한**: 사용자 관리, 팀 권한
- **파일 스토리지**: 이미지, 문서 저장

**Airtable 활용 영역**:

- **템플릿 관리**: 제안서, 기획서 템플릿
- **메타데이터**: 산업별, 프로젝트 타입별 데이터
- **외부 연동**: 마케팅 도구, 분석 도구
- **백업/아카이브**: 히스토리 데이터 보관

**하이브리드 아키텍처 장점**:

1. **성능 최적화**: 구조화된 데이터는 Supabase에서 빠른 쿼리
2. **유연성**: 스키마 변경이 빈번한 템플릿은 Airtable에서 관리
3. **협업**: 비개발자도 Airtable에서 템플릿 수정 가능
4. **확장성**: 각 도구의 강점을 활용한 점진적 확장

## 3. 기술 아키텍처

### 3.1 시스템 아키텍처

#### A. Frontend 아키텍처

**기술 스택**:

- **Next.js 14**: App Router, SSR/SSG
- **TypeScript**: 타입 안전성
- **Tailwind CSS**: 유틸리티 퍼스트 CSS
- **Zustand**: 상태 관리
- **React Query**: 서버 상태 관리

**주요 컴포넌트**:

- **Layout System**: 반응형 레이아웃
- **Chat Interface**: 실시간 챗 UI
- **Canvas System**: 코드/이미지 캔버스
- **Document Viewer**: PDF/DOC 뷰어
- **Project Dashboard**: 대시보드 UI

#### B. Backend 아키텍처

**기술 스택**:

- **Node.js + Express**: RESTful API
- **Socket.io**: 실시간 통신
- **Prisma**: ORM (Object-Relational Mapping)
- **JWT**: 인증 토큰
- **Multer**: 파일 업로드

**마이크로서비스 구조**:

- **Auth Service**: 인증/권한 관리
- **AI Service**: AI 모델 라우팅
- **File Service**: 파일 처리/변환
- **Canvas Service**: 코드 실행 환경
- **Image Service**: 이미지 생성/처리

#### C. Database 설계

**Supabase 스키마**:

```sql
-- 사용자 관리
users (
  id, email, name, avatar_url,
  subscription_tier, created_at
)

-- 프로젝트 관리
projects (
  id, user_id, name, description,
  category, status, created_at
)

-- 대화 기록
conversations (
  id, project_id, title,
  model_used, created_at
)

messages (
  id, conversation_id, role,
  content, metadata, created_at
)

-- 커스텀 챗봇
custom_bots (
  id, user_id, name, description,
  knowledge_base, is_public, created_at
)

-- 이미지 관리
generated_images (
  id, user_id, prompt, model_used,
  image_url, metadata, created_at
)

-- 문서 관리
documents (
  id, project_id, file_name, file_type,
  processed_content, metadata, created_at
)
```

### 3.2 AI Integration 설계

#### A. AI 모델 라우터

**요청 처리 플로우**:

1. 사용자 요청 분석
2. 최적 모델 선택
3. 컨텍스트 준비
4. API 호출 실행
5. 응답 후처리

**모델 선택 로직**:

```typescript
interface ModelSelection {
  complexity: 'simple' | 'medium' | 'complex'
  speed: 'fast' | 'balanced' | 'quality'
  cost: 'low' | 'medium' | 'high'
  features: string[]
}

function selectModel(request: ChatRequest): AIModel {
  if (request.requiresMCP) return 'claude'
  if (request.isSimpleQuery) return 'gemini'
  if (request.needsCreativity) return 'chatgpt'
  return 'gemini' // default
}
```

#### B. MCP 연동 시스템

**지원 도구**:

- **web_search**: 실시간 웹 검색
- **filesystem**: 파일 읽기/쓰기
- **database**: Supabase 쿼리
- **image_generation**: 이미지 생성
- **code_execution**: 코드 실행

**보안 고려사항**:

- 샌드박스 환경에서 실행
- 리소스 사용량 제한
- 접근 권한 제어
- 로그 및 모니터링

### 3.3 보안 및 성능

#### A. 보안 요구사항

**인증/권한**:

- JWT 기반 토큰 인증
- 역할 기반 접근 제어 (RBAC)
- API 요청 제한 (Rate Limiting)
- CORS 정책 설정

**데이터 보안**:

- 문서 암호화 저장
- 개인정보 마스킹
- 감사 로그 기록
- GDPR 준수

**코드 실행 보안**:

- 컨테이너 격리
- 네트워크 접근 제한
- 실행 시간 제한
- 악성 코드 탐지

#### B. 성능 최적화

**프론트엔드**:

- 코드 스플리팅
- 이미지 최적화
- CDN 활용
- 캐싱 전략

**백엔드**:

- 연결 풀링
- 쿼리 최적화
- 백그라운드 작업
- 로드 밸런싱

## 4. 사용자 플로우

### 4.1 제안 진행 플로우

#### A. RFP 업로드 및 분석

1. **문서 업로드**
   - 드래그 앤 드롭 인터페이스
   - 다중 파일 업로드 지원
   - 진행 상태 표시

2. **자동 분석**
   - 텍스트 추출 및 파싱
   - 요구사항 자동 인식
   - 구조화된 데이터 생성

3. **결과 확인**
   - 분석 결과 대시보드
   - 수정/보완 인터페이스
   - 추가 정보 입력

#### B. 시장 조사 자동화

1. **조사 범위 설정**
   - 경쟁사 키워드 입력
   - 조사 항목 선택
   - 깊이 수준 설정

2. **자동 조사 실행**
   - 웹 검색 기반 정보 수집
   - AI 분석 및 요약
   - 구조화된 리포트 생성

3. **결과 검토 및 활용**
   - 인터랙티브 리포트
   - 제안서 연동
   - 추가 조사 요청

#### C. 제안서 작성

1. **템플릿 선택**
   - 산업별 템플릿
   - 프로젝트 타입별 구조
   - 커스텀 템플릿

2. **AI 기반 초안 생성**
   - RFP 내용 기반 자동 작성
   - 시장 조사 결과 반영
   - 구조화된 제안서 생성

3. **협업 편집**
   - 실시간 공동 편집
   - 댓글 및 리뷰 기능
   - 버전 관리

### 4.2 구축 관리 플로우

#### A. 프로젝트 초기화

1. **프로젝트 생성**
   - 기본 정보 입력
   - 팀 멤버 초대
   - 역할 할당

2. **요구사항 정리**
   - 기능 목록 작성
   - 우선순위 설정
   - 수용 기준 정의

3. **일정 계획**
   - WBS 생성
   - 마일스톤 설정
   - 리소스 할당

#### B. 개발 진행 관리

1. **스프린트 계획**
   - 백로그 관리
   - 스프린트 목표 설정
   - 태스크 할당

2. **진행 추적**
   - 번다운 차트
   - 실시간 진행률
   - 병목 지점 식별

3. **품질 관리**
   - 테스트 케이스 관리
   - 버그 추적
   - 코드 리뷰

### 4.3 운영 관리 플로우

#### A. 요건 접수 및 분류

1. **요건 등록**
   - 고객 요청 입력
   - 우선순위 설정
   - 담당자 배정

2. **영향도 분석**
   - 기술적 복잡도 평가
   - 비용/시간 추정
   - 리스크 분석

3. **승인 프로세스**
   - 이해관계자 검토
   - 승인/반려 결정
   - 피드백 전달

#### B. 업무 분배 및 추적

1. **태스크 생성**
   - 작업 유형별 분류
   - 상세 요구사항 작성
   - 완료 기준 정의

2. **팀별 할당**
   - 기획팀: 요구사항 분석, 기능 설계
   - 디자인팀: UI/UX 설계, 프로토타입
   - 퍼블리싱팀: 마크업, 스타일링
   - 개발팀: 백엔드/프론트엔드 구현

3. **진행 모니터링**
   - 실시간 상태 업데이트
   - 지연 알림
   - 병목 지점 해결

## 5. 개발 계획

### 5.1 개발 단계별 계획

#### Phase 1: 기반 구조 구축 (4주)

**주요 개발 항목**:

- 프로젝트 초기 설정
- 기본 인증/권한 시스템
- Supabase 연동
- 기본 UI 컴포넌트

**구체적 작업**:

1. **개발 환경 설정**
   - Next.js 프로젝트 초기화
   - TypeScript 설정
   - Tailwind CSS 설정
   - ESLint/Prettier 설정

2. **데이터베이스 설계**
   - Supabase 프로젝트 생성
   - 스키마 설계 및 마이그레이션
   - Row Level Security 설정

3. **인증 시스템**
   - Supabase Auth 연동
   - JWT 토큰 관리
   - 권한 기반 라우팅

4. **기본 UI 구조**
   - 레이아웃 컴포넌트
   - 네비게이션 시스템
   - 반응형 디자인

#### Phase 2: AI 챗봇 시스템 (6주)

**주요 개발 항목**:

- AI 모델 연동
- 챗봇 인터페이스
- 대화 기록 관리
- 기본 MCP 연동

**구체적 작업**:

1. **AI 서비스 구축**
   - Gemini API 연동
   - ChatGPT API 연동
   - Claude API 연동
   - 모델 라우팅 로직

2. **채팅 인터페이스**
   - 실시간 채팅 UI
   - 메시지 포맷팅
   - 파일 업로드 기능
   - 채팅 히스토리

3. **MCP 기본 연동**
   - 웹 검색 도구
   - 파일 시스템 접근
   - 기본 데이터베이스 쿼리

#### Phase 3: 코드 캔버스 시스템 (4주)

**주요 개발 항목**:

- 코드 에디터 구현
- 실행 환경 구축
- 캔버스 UI/UX
- 코드 공유 기능

**구체적 작업**:

1. **코드 에디터**
   - Monaco Editor 통합
   - 언어별 문법 하이라이팅
   - 자동완성 기능
   - 에러 표시

2. **실행 환경**
   - 브라우저 내 JavaScript 실행
   - Python/Node.js 백엔드 실행
   - 보안 샌드박스 구현

3. **캔버스 시스템**
   - 사이드바 캔버스
   - 전체화면 모드
   - 분할 화면 뷰
   - 새창 팝업

#### Phase 4: 이미지 생성 시스템 (3주)

**주요 개발 항목**:

- 이미지 생성 API 연동
- 이미지 관리 시스템
- 갤러리 인터페이스

**구체적 작업**:

1. **이미지 생성 API**
   - Flux Schnell 연동
   - Imagen 3 연동
   - 프롬프트 최적화

2. **이미지 관리**
   - 업로드/다운로드
   - 메타데이터 관리
   - 태그 시스템

3. **갤러리 UI**
   - 그리드 레이아웃
   - 필터링/검색
   - 편집 인터페이스

#### Phase 5: 프로젝트 관리 기능 (5주)

**주요 개발 항목**:

- 3대 카테고리 구현
- 문서 관리 시스템
- 워크플로우 엔진

**구체적 작업**:

1. **제안 진행 모듈**
   - RFP 업로드/분석
   - 시장 조사 자동화
   - 제안서 생성

2. **구축 관리 모듈**
   - 요구사항 관리
   - 일정 계획/추적
   - QA 관리

3. **운영 관리 모듈**
   - 요건 관리 시스템
   - 팀별 업무 분배
   - 성과 모니터링

#### Phase 6: 고급 기능 및 최적화 (4주)

**주요 개발 항목**:

- RAG 시스템 구현
- 성능 최적화
- 보안 강화
- 테스트 및 배포

**구체적 작업**:

1. **RAG 시스템**
   - 벡터 데이터베이스 구축
   - 커스텀 챗봇 생성
   - 지식 베이스 관리

2. **성능 최적화**
   - 코드 스플리팅
   - 이미지 최적화
   - 캐싱 전략

3. **보안 및 테스트**
   - 보안 감사
   - 자동화 테스트
   - 성능 테스트

### 5.2 개발 리소스 계획

#### A. 팀 구성

**필수 역할**:

- **풀스택 개발자** (1명): 전체 아키텍처 설계 및 구현
- **프론트엔드 개발자** (1명): UI/UX 구현 전문
- **백엔드 개발자** (1명): API 및 서버 로직 전문
- **AI/ML 엔지니어** (1명): AI 모델 연동 및 최적화

**선택적 역할**:

- **DevOps 엔지니어**: 배포 및 인프라 관리
- **QA 엔지니어**: 품질 보증 및 테스트
- **UX 디자이너**: 사용자 경험 설계

#### B. 기술 스택 선정 기준

**우선순위**:

1. **개발 속도**: 빠른 프로토타이핑 가능
2. **확장성**: 사용자 증가에 대응 가능
3. **유지보수성**: 코드 가독성 및 모듈화
4. **커뮤니티**: 활발한 생태계 및 지원

**최종 선정**:

- **Frontend**: Next.js + TypeScript + Tailwind
- **Backend**: Node.js + Express + Prisma
- **Database**: Supabase (PostgreSQL)
- **Deployment**: Vercel + Railway

## 6. 성공 지표 및 KPI

### 6.1 비즈니스 KPI

- **사용자 증가율**: 월간 활성 사용자 20% 증가
- **프로젝트 완료율**: 플랫폼 내 프로젝트 80% 완료
- **사용자 만족도**: NPS 스코어 50 이상
- **매출 성장**: 분기별 30% 성장

### 6.2 기술 KPI

- **응답 시간**: AI 응답 평균 3초 이내
- **시스템 안정성**: 99.9% 업타임 유지
- **보안 사고**: 제로 데이터 유출
- **성능**: 페이지 로딩 2초 이내

### 6.3 사용자 행동 KPI

- **DAU/MAU 비율**: 30% 이상
- **세션 지속 시간**: 평균 15분 이상
- **기능 사용률**: 핵심 기능 70% 이상 사용
- **재방문율**: 일주일 내 60% 재방문

## 7. 위험 요소 및 대응 방안

### 7.1 기술적 위험

**위험 요소**:

- AI API 비용 증가
- 실시간 성능 이슈
- 보안 취약점

**대응 방안**:

- AI 모델 최적화 및 캐싱
- 성능 모니터링 및 최적화
- 정기적 보안 감사

### 7.2 비즈니스 위험

**위험 요소**:

- 경쟁사 등장
- 시장 변화
- 사용자 이탈

**대응 방안**:

- 지속적 혁신
- 시장 트렌드 모니터링
- 사용자 피드백 적극 반영

---

_문서 버전: 1.0_  
_작성일: 2025-08-20_  
_다음 업데이트: 개발 진행에 따라 주간 업데이트_
